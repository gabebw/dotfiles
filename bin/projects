#!/usr/local/bin/fish

# List all directories in $PROJECT_DIRECTORIES that contain git repositories.

function cdpath_directories
  for dir in $PROJECT_DIRECTORIES
    find -L "$dir" \
      -not -path '*/\.*' \
      -type d \
      -maxdepth 1
  end
end

function is_a_git_repo
  while read -l dir
    if [ -d "$dir/.git" ]
      echo "$dir"
    end
  end
end

cdpath_directories | sort -u | is_a_git_repo
